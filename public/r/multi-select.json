{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "multi-select",
  "type": "registry:component",
  "title": "Multi Select",
  "description": "A combobox to select multiple options.",
  "dependencies": [
    "lucide-react",
    "@radix-ui/react-slot",
    "class-variance-authority",
    "embla-carousel-react",
    "@radix-ui/react-popover",
    "@radix-ui/react-checkbox",
    "cmdk",
    "@radix-ui/react-dialog",
    "@radix-ui/react-separator"
  ],
  "registryDependencies": [
    "https://ntt-shadcn-registry.vercel.app/r/badge.json",
    "https://ntt-shadcn-registry.vercel.app/r/button.json",
    "https://ntt-shadcn-registry.vercel.app/r/checkbox.json",
    "https://ntt-shadcn-registry.vercel.app/r/command.json",
    "https://ntt-shadcn-registry.vercel.app/r/popover.json",
    "https://ntt-shadcn-registry.vercel.app/r/separator.json",
    "https://ntt-shadcn-registry.vercel.app/r/spinner.json",
    "https://ntt-shadcn-registry.vercel.app/r/dialog.json"
  ],
  "files": [
    {
      "path": "src/registry/new-york/molecules/multi-select/components/multi-select.tsx",
      "content": "import { ChevronDown, XIcon } from 'lucide-react'\nimport React from 'react'\nimport { Badge, type BadgeProps } from '@/components/ui/badge'\nimport { Button, type ButtonProps } from '@/components/ui/button'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  type CommandInputProps,\n  CommandItem,\n  type CommandItemProps,\n  CommandList,\n  type CommandListProps,\n  type CommandProps\n} from '@/components/ui/command'\nimport {\n  Popover,\n  PopoverContent,\n  type PopoverContentProps,\n  type PopoverProps,\n  PopoverTrigger,\n  type PopoverTriggerProps\n} from '@/components/ui/popover'\nimport { Separator } from '@/components/ui/separator'\nimport { Spinner } from '@/components/ui/spinner'\nimport type { Option } from '@/types/base'\nimport { cn } from '@/utils/ui'\n\n// Multi select\nexport interface MultiSelectProps {\n  value: Array<Option['value']>\n  options: Option[]\n  placeholder?: string\n  max?: number\n  isServerSideSearching?: boolean\n  popoverProps?: PopoverProps\n  popoverTriggerProps?: PopoverTriggerProps\n  popoverContentProps?: PopoverContentProps\n  buttonTriggerProps?: ButtonProps\n  selectedOptionBadgeProps?: Omit<BadgeProps, 'children'> & {\n    children: (option: Option) => React.ReactNode\n  }\n  commandProps?: CommandProps\n  commandInputProps?: CommandInputProps\n  commandListProps?: CommandListProps\n  commandItemProps?: Omit<CommandItemProps, 'children'> & {\n    children: (option: Option) => React.ReactNode\n  }\n  commandGroupSlot?: React.ReactNode\n  onValueChange: (value: MultiSelectProps['value']) => void\n}\n\nexport const MultiSelect = ({\n  value,\n  options,\n  placeholder,\n  max = Infinity,\n  isServerSideSearching,\n  popoverProps,\n  popoverTriggerProps,\n  buttonTriggerProps,\n  popoverContentProps,\n  selectedOptionBadgeProps,\n  commandProps,\n  commandInputProps,\n  commandListProps,\n  commandItemProps,\n  commandGroupSlot,\n  onValueChange\n}: MultiSelectProps) => {\n  // Refs\n  const valueContainerRef = React.useRef<HTMLDivElement>(null)\n  const overflowBadgeRef = React.useRef<HTMLSpanElement>(null)\n\n  // States\n  const [overflowItemCount, setOverflowItemCount] = React.useState(0)\n\n  // Methods\n  const resize = React.useCallback((node: HTMLDivElement) => {\n    valueContainerRef.current = node\n\n    const checkOverflow = () => {\n      const containerElement = valueContainerRef.current\n      if (!containerElement) return\n\n      const items = Array.from(\n        containerElement.querySelectorAll<HTMLSpanElement>('span[data-slot=\"badge\"][data-option=\"true\"]')\n      )\n\n      items.forEach((item) => {\n        item.style.removeProperty('display')\n      })\n\n      let overflowCount = 0\n      for (let i = items.length - 1; i >= 0; i--) {\n        if (containerElement.scrollWidth <= containerElement.clientWidth) break\n\n        overflowCount++\n        items[i].style.display = 'none'\n        overflowBadgeRef.current?.style.removeProperty('display')\n      }\n      setOverflowItemCount(overflowCount)\n    }\n\n    const mutationObserver = new MutationObserver(checkOverflow)\n    const resizeObserver = new ResizeObserver(checkOverflow)\n\n    mutationObserver.observe(node, {\n      childList: true,\n      attributes: true,\n      attributeFilter: ['class', 'style']\n    })\n    resizeObserver.observe(node)\n\n    return () => {\n      mutationObserver.disconnect()\n      resizeObserver.disconnect()\n    }\n  }, [])\n\n  const toggleOption = (option: Option['value']) => {\n    const newSelectedValues = value.includes(option) ? value.filter((value) => value !== option) : [...value, option]\n    onValueChange(newSelectedValues)\n  }\n\n  const deleteOption = (e: React.MouseEvent<HTMLSpanElement>, option: Option['value']) => {\n    e.stopPropagation()\n    toggleOption(option)\n  }\n\n  const deleteExtraOptions = (e: React.MouseEvent<HTMLSpanElement>) => {\n    e.stopPropagation()\n    const newSelectedValues = value.slice(0, value.length - overflowItemCount)\n    onValueChange(newSelectedValues)\n  }\n\n  const deleteAllOptions = (e: React.MouseEvent<SVGSVGElement>) => {\n    e.stopPropagation()\n    onValueChange([])\n  }\n\n  // Template\n  return (\n    <Popover {...popoverProps} modal>\n      <PopoverTrigger {...popoverTriggerProps} asChild={popoverTriggerProps?.asChild ?? true}>\n        <Button\n          {...buttonTriggerProps}\n          variant='outline'\n          data-empty={value.length === 0}\n          className={cn(\n            'w-full justify-start font-normal data-[empty=true]:text-muted-foreground [&_svg]:pointer-events-auto',\n            buttonTriggerProps?.className\n          )}\n        >\n          {value.length > 0 ? (\n            <React.Fragment>\n              <div ref={resize} className='flex grow items-center gap-2 overflow-hidden'>\n                {value.map((value) => {\n                  const option = options.find((option) => option.value === value)\n                  return option ? (\n                    <Badge\n                      key={value}\n                      variant='secondary'\n                      data-option='true'\n                      {...selectedOptionBadgeProps}\n                      className={cn(\n                        '[&>svg]:transition-transform hover:[&>svg]:scale-125',\n                        selectedOptionBadgeProps?.className\n                      )}\n                      onClick={(e) => deleteOption(e, value)}\n                    >\n                      {option && selectedOptionBadgeProps?.children\n                        ? selectedOptionBadgeProps.children(option)\n                        : option.label}\n                      <XIcon />\n                    </Badge>\n                  ) : null\n                })}\n\n                <Badge\n                  ref={overflowBadgeRef}\n                  variant='secondary'\n                  {...selectedOptionBadgeProps}\n                  className={cn(\n                    '[&>svg]:transition-transform hover:[&>svg]:scale-125',\n                    selectedOptionBadgeProps?.className\n                  )}\n                  style={{\n                    display: overflowItemCount > 0 ? 'flex' : 'none'\n                  }}\n                  onClick={deleteExtraOptions}\n                >\n                  {`+ ${overflowItemCount}`}\n                  <XIcon />\n                </Badge>\n              </div>\n\n              <XIcon\n                className='size-4 text-muted-foreground transition-transform hover:scale-125'\n                onClick={deleteAllOptions}\n              />\n\n              <Separator orientation='vertical' className='flex h-full min-h-6' />\n            </React.Fragment>\n          ) : (\n            <div className='line-clamp-1 text-ellipsis'>{placeholder}</div>\n          )}\n\n          <ChevronDown className='ml-auto size-4 shrink-0 text-muted-foreground' />\n        </Button>\n      </PopoverTrigger>\n\n      <PopoverContent\n        {...popoverContentProps}\n        align={popoverContentProps?.align ?? 'start'}\n        className={cn('min-w-(--radix-popover-trigger-width) p-0', popoverContentProps?.className)}\n      >\n        <Command {...commandProps}>\n          <div className='flex items-center gap-2 border-input border-b px-3'>\n            <Checkbox\n              checked={value.length === options.length || (value.length > 0 && 'indeterminate')}\n              onCheckedChange={(checked) => {\n                onValueChange(checked ? options.map((option) => option.value) : [])\n              }}\n            />\n            <div className='[&>div]:flex-1 [&>div]:border-b-0 [&>div]:border-b-none [&>div]:px-0'>\n              <CommandInput placeholder='Search' {...commandInputProps}>\n                {isServerSideSearching && <Spinner />}\n              </CommandInput>\n            </div>\n          </div>\n\n          <div className='relative'>\n            <CommandList {...commandListProps} className={cn('scrollbar', commandListProps?.className)}>\n              <CommandEmpty>No option found.</CommandEmpty>\n              <CommandGroup>\n                {options.map((option) => {\n                  const isSelected = value.includes(option.value)\n                  const isDisabled = !isSelected && value.length === max\n\n                  return (\n                    <CommandItem\n                      disabled={isDisabled}\n                      key={option.value}\n                      value={option.label}\n                      onSelect={() => toggleOption(option.value)}\n                    >\n                      <Checkbox checked={isSelected} />\n                      {commandItemProps?.children ? commandItemProps.children(option) : option.label}\n                    </CommandItem>\n                  )\n                })}\n\n                {commandGroupSlot && commandGroupSlot}\n              </CommandGroup>\n            </CommandList>\n          </div>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  )\n}\n",
      "type": "registry:ui",
      "target": "src/components/molecules/multi-select/index.tsx"
    },
    {
      "path": "src/types/base.ts",
      "content": "export interface Option {\n  value: string\n  label: string\n}\n",
      "type": "registry:file",
      "target": "src/types/base.ts"
    }
  ]
}