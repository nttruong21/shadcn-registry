{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "year-picker",
  "type": "registry:component",
  "title": "Year Picker",
  "description": "A combobox to select a year.",
  "dependencies": [
    "date-fns",
    "lucide-react",
    "@radix-ui/react-slot",
    "class-variance-authority",
    "cmdk",
    "@radix-ui/react-dialog",
    "@radix-ui/react-popover",
    "@radix-ui/react-label",
    "@radix-ui/react-popover"
  ],
  "registryDependencies": [
    "https://ntt-shadcn-registry.vercel.app/r/button.json",
    "https://ntt-shadcn-registry.vercel.app/r/combobox.json",
    "https://ntt-shadcn-registry.vercel.app/r/label.json",
    "https://ntt-shadcn-registry.vercel.app/r/popover.json",
    "https://ntt-shadcn-registry.vercel.app/r/spinner.json",
    "https://ntt-shadcn-registry.vercel.app/r/command.json",
    "https://ntt-shadcn-registry.vercel.app/r/dialog.json"
  ],
  "files": [
    {
      "path": "src/registry/new-york/molecules/year-picker/components/year-picker.tsx",
      "content": "import { add, format, isAfter, isBefore, max, min, set, sub } from 'date-fns'\nimport { ChevronDown, X } from 'lucide-react'\nimport React from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Combobox, type ComboboxProps } from '@/components/ui/combobox'\nimport { Label } from '@/components/ui/label'\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\nimport { cn } from '@/utils/ui'\n\nexport const generateOptions = (startYear: number, endYear: number): ComboboxProps['options'] => {\n  return Array.from({\n    length: endYear - startYear + 1\n  }).map((_, index) => {\n    const optionValue = `${index + startYear}`\n    return {\n      value: optionValue,\n      label: optionValue\n    }\n  })\n}\n\nexport const today = new Date()\nexport const yearOffset = 100\nexport const defaultOptions = generateOptions(today.getFullYear() - yearOffset, today.getFullYear() + yearOffset)\n\n// Year picker\nexport type YearPickerProps = Omit<ComboboxProps, 'options'> & {\n  minDate?: Date\n  maxDate?: Date\n}\n\nexport const YearPicker = ({ minDate, maxDate, ...props }: YearPickerProps) => {\n  // Memos\n  const options = React.useMemo<ComboboxProps['options']>(() => {\n    // Has not both min date and max date\n    if (!minDate && !maxDate) {\n      return defaultOptions\n    }\n\n    // Has both min date and max date\n    if (minDate && maxDate) {\n      return generateOptions(minDate.getFullYear(), maxDate.getFullYear())\n    }\n\n    // Only has min date\n    if (minDate) {\n      return generateOptions(\n        minDate.getFullYear(),\n        add(max([minDate, today]), {\n          years: yearOffset\n        }).getFullYear()\n      )\n    }\n\n    // Only has max date\n    if (maxDate) {\n      return generateOptions(\n        sub(min([today, maxDate]), {\n          years: yearOffset\n        }).getFullYear(),\n        maxDate.getFullYear()\n      )\n    }\n\n    return []\n  }, [minDate, maxDate])\n\n  // Template\n  return <Combobox {...props} options={options} />\n}\n\n// Year range picker\nexport type YearRangePickerProps = Omit<YearPickerProps, 'value' | 'onValueChange'> & {\n  value: { start: Date | null | undefined; end: Date | null | undefined } | null | undefined\n  onValueChange: (value: YearRangePickerProps['value']) => void\n}\n\nexport const YearRangePicker = ({\n  value,\n  minDate,\n  maxDate,\n  placeholder,\n  isCanRemoveValue = true,\n  popoverProps,\n  popoverTriggerProps,\n  buttonTriggerProps,\n  popoverContentProps,\n  onValueChange\n}: YearRangePickerProps) => {\n  // Memos\n  const options = React.useMemo<ComboboxProps['options']>(() => {\n    // Has not both min date and max date\n    if (!minDate && !maxDate) {\n      return defaultOptions\n    }\n\n    // Has both min date and max date\n    if (minDate && maxDate) {\n      return generateOptions(minDate.getFullYear(), maxDate.getFullYear())\n    }\n\n    // Only has min date\n    if (minDate) {\n      return generateOptions(\n        minDate.getFullYear(),\n        add(max([minDate, today]), {\n          years: yearOffset\n        }).getFullYear()\n      )\n    }\n\n    // Only has max date\n    if (maxDate) {\n      return generateOptions(\n        sub(min([today, maxDate]), {\n          years: yearOffset\n        }).getFullYear(),\n        maxDate.getFullYear()\n      )\n    }\n\n    return []\n  }, [minDate, maxDate])\n\n  const isEmpty = React.useMemo(() => {\n    return !value?.start || !value?.end\n  }, [value])\n\n  // Template\n  return (\n    <Popover {...popoverProps}>\n      <PopoverTrigger {...popoverTriggerProps} asChild={popoverTriggerProps?.asChild ?? true}>\n        {popoverTriggerProps?.children ?? (\n          <Button\n            variant='outline'\n            role='combobox'\n            data-empty={isEmpty}\n            {...buttonTriggerProps}\n            className={cn(\n              'w-full justify-start font-normal data-[empty=true]:text-muted-foreground [&_svg]:pointer-events-auto',\n              buttonTriggerProps?.className\n            )}\n          >\n            {buttonTriggerProps?.children ?? (\n              <React.Fragment>\n                <span className='line-clamp-1 block text-ellipsis'>\n                  {value?.start && value?.end\n                    ? `${format(value.start, 'yyyy')} - ${format(value.end, 'yyyy')}`\n                    : placeholder}\n                </span>\n\n                {isCanRemoveValue && !isEmpty ? (\n                  <X\n                    className='ml-auto size-4 shrink-0 text-muted-foreground transition-transform hover:scale-125'\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      onValueChange(null)\n                    }}\n                  />\n                ) : (\n                  <ChevronDown className='ml-auto size-4 shrink-0 text-muted-foreground' />\n                )}\n              </React.Fragment>\n            )}\n          </Button>\n        )}\n      </PopoverTrigger>\n\n      <PopoverContent\n        {...popoverContentProps}\n        className={cn('min-w-(--radix-popover-trigger-width) p-0', popoverContentProps?.className)}\n      >\n        <div className='space-y-4 p-4'>\n          {/* Start */}\n          <div className='space-y-2'>\n            <Label>Start year</Label>\n            <Combobox\n              value={value?.start?.getFullYear().toString()}\n              placeholder='Select year'\n              isCanRemoveValue={false}\n              options={options}\n              onValueChange={(yearValue) => {\n                if (!yearValue) return\n\n                const date = set(today, {\n                  date: 1,\n                  month: value?.start ? value.start.getMonth() : 0,\n                  year: +yearValue\n                })\n\n                const changeDate = value?.end ? min([date, value.end]) : date\n\n                if (minDate && isBefore(changeDate, minDate)) {\n                  return onValueChange({\n                    start: minDate,\n                    end: value?.end\n                  })\n                }\n\n                if (maxDate && isAfter(changeDate, maxDate)) {\n                  return onValueChange({\n                    start: maxDate,\n                    end: value?.end\n                  })\n                }\n\n                onValueChange({\n                  start: changeDate,\n                  end: value?.end\n                })\n              }}\n            />\n          </div>\n\n          {/* End */}\n          <div className='space-y-2'>\n            <Label>End year</Label>\n            <Combobox\n              value={value?.end?.getFullYear().toString()}\n              placeholder='Select year'\n              isCanRemoveValue={false}\n              options={options}\n              onValueChange={(yearValue) => {\n                if (!yearValue) return\n\n                const date = set(today, {\n                  date: 1,\n                  month: value?.end ? value.end.getMonth() : 0,\n                  year: +yearValue\n                })\n\n                const changeDate = value?.start ? max([value.start, date]) : date\n\n                if (minDate && isBefore(changeDate, minDate)) {\n                  return onValueChange({\n                    start: value?.start,\n                    end: minDate\n                  })\n                }\n\n                if (maxDate && isAfter(changeDate, maxDate)) {\n                  return onValueChange({\n                    start: value?.start,\n                    end: maxDate\n                  })\n                }\n\n                onValueChange({\n                  start: value?.start,\n                  end: changeDate\n                })\n              }}\n            />\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n",
      "type": "registry:ui",
      "target": "src/components/molecules/year-picker/index.tsx"
    }
  ]
}