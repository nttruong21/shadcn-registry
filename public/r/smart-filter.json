{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "smart-filter",
  "type": "registry:component",
  "title": "Smart Filter",
  "description": "Powerful component with search and filter by multiple conditions that can switch back and forth.",
  "dependencies": [
    "react-hook-form",
    "lucide-react",
    "cmdk",
    "@radix-ui/react-dialog",
    "@radix-ui/react-popover",
    "date-fns",
    "@radix-ui/react-slot",
    "class-variance-authority",
    "@radix-ui/react-checkbox",
    "@radix-ui/react-separator",
    "react-number-format",
    "date-fns",
    "react-day-picker",
    "@radix-ui/react-label",
    "@uidotdev/usehooks"
  ],
  "registryDependencies": [
    "https://ntt-shadcn-registry.vercel.app/r/combobox.json",
    "https://ntt-shadcn-registry.vercel.app/r/button.json",
    "https://ntt-shadcn-registry.vercel.app/r/multi-select.json",
    "https://ntt-shadcn-registry.vercel.app/r/badge.json",
    "https://ntt-shadcn-registry.vercel.app/r/checkbox.json",
    "https://ntt-shadcn-registry.vercel.app/r/command.json",
    "https://ntt-shadcn-registry.vercel.app/r/popover.json",
    "https://ntt-shadcn-registry.vercel.app/r/separator.json",
    "https://ntt-shadcn-registry.vercel.app/r/spinner.json",
    "https://ntt-shadcn-registry.vercel.app/r/dialog.json",
    "https://ntt-shadcn-registry.vercel.app/r/number-input.json",
    "https://ntt-shadcn-registry.vercel.app/r/button-group.json",
    "https://ntt-shadcn-registry.vercel.app/r/input.json",
    "https://ntt-shadcn-registry.vercel.app/r/input-group.json",
    "https://ntt-shadcn-registry.vercel.app/r/textarea.json",
    "https://ntt-shadcn-registry.vercel.app/r/date-picker.json",
    "https://ntt-shadcn-registry.vercel.app/r/calendar.json",
    "https://ntt-shadcn-registry.vercel.app/r/field.json",
    "https://ntt-shadcn-registry.vercel.app/r/label.json"
  ],
  "files": [
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/advanced-filter-name-field.tsx",
      "content": "import React from 'react'\nimport { type ControllerRenderProps, useFormContext } from 'react-hook-form'\nimport { Combobox, type ComboboxProps } from '@/components/ui/combobox'\nimport {\n  defaultValuePerOperation,\n  operationsPerType,\n  type SmartFilterFormInput,\n  type SmartFilterFormOutput\n} from './lib'\nimport { useSmartFilterContext } from './smart-filter'\n\n// Component\nconst AdvancedFilterNameField = ({\n  index,\n  field,\n  formFiltersWatcher\n}: {\n  index: number\n  field: ControllerRenderProps<SmartFilterFormInput, `filters.${number}.name`>\n  formFiltersWatcher: SmartFilterFormInput['filters']\n}) => {\n  // Hooks\n  const { filters } = useSmartFilterContext()\n  const form = useFormContext<SmartFilterFormInput, unknown, SmartFilterFormOutput>()\n\n  // Methods\n  const changeValue: ComboboxProps['onValueChange'] = (value) => {\n    if (!value) return\n\n    const selectedFilter = filters.find((filter) => filter.name === value)\n    if (!selectedFilter) return\n\n    const operation = operationsPerType[selectedFilter.type][0]\n    form.setValue(`filters.${index}.type`, selectedFilter.type)\n    form.setValue(`filters.${index}.operation`, operation)\n    form.setValue(`filters.${index}.value`, defaultValuePerOperation[operation])\n\n    field.onChange(value)\n  }\n\n  // Memos\n  const options = React.useMemo<ComboboxProps['options']>(() => {\n    const selectedFilters = formFiltersWatcher.map((field) => field.name)\n    return filters\n      .filter((filter) => filter.name === field.value || !selectedFilters.includes(filter.name))\n      .map((filter) => ({\n        value: filter.name,\n        label: filter.label\n      }))\n  }, [filters, formFiltersWatcher, field.value])\n\n  // Template\n  return <Combobox value={field.value} options={options} isCanRemoveValue={false} onValueChange={changeValue} />\n}\n\nexport default AdvancedFilterNameField\n",
      "type": "registry:ui",
      "target": "src/components/organisms/smart-filter/advanced-filter-name-field.tsx"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/advanced-filter-operation-field.tsx",
      "content": "import React from 'react'\nimport { type ControllerRenderProps, useFormContext, useWatch } from 'react-hook-form'\nimport { Combobox, type ComboboxProps } from '@/components/ui/combobox'\nimport {\n  defaultValuePerOperation,\n  operationsPerType,\n  type SmartFilterFormInput,\n  type SmartFilterFormOutput,\n  type SmartFilterOperation,\n  SmartFilterType\n} from './lib'\nimport { useSmartFilterContext } from './smart-filter'\n\nconst operationLabels: Record<string, Record<string, string | undefined> | undefined> = {\n  base: {\n    equalsTo: 'Equals to',\n    doesNotEqualTo: 'Does not equal to',\n    contains: 'Contains',\n    isBetween: 'Is between',\n    hasAnyOf: 'Has any of',\n    hasAllOf: 'Has all of'\n  },\n  [SmartFilterType.Number]: {\n    isLessThan: 'Is less than',\n    isLessThanOrEqualTo: 'Is less than or equal to',\n    isGreaterThan: 'Is greater than',\n    isGreaterThanOrEqualTo: 'Is greater than or equal to'\n  },\n  [SmartFilterType.Date]: {\n    isLessThan: 'Is before',\n    isLessThanOrEqualTo: 'Is before or equal to',\n    isGreaterThan: 'Is after',\n    isGreaterThanOrEqualTo: 'Is after or equal to'\n  }\n}\n\n// Component\nconst AdvancedFilterOperationField = ({\n  index,\n  field\n}: {\n  index: number\n  field: ControllerRenderProps<SmartFilterFormInput, `filters.${number}.operation`>\n}) => {\n  // Hooks\n  const { filters } = useSmartFilterContext()\n  const form = useFormContext<SmartFilterFormInput, unknown, SmartFilterFormOutput>()\n  const formFilterName = useWatch({\n    name: `filters.${index}.name`,\n    control: form.control\n  })\n\n  // Methods\n  const changeValue: ComboboxProps['onValueChange'] = (value) => {\n    if (!value) return\n    form.setValue(`filters.${index}.value`, defaultValuePerOperation[value as SmartFilterOperation])\n    field.onChange(value)\n  }\n\n  // Memos\n  const options = React.useMemo<ComboboxProps['options']>(() => {\n    const type = filters.find((filter) => filter.name === formFilterName)?.type\n    return type\n      ? operationsPerType[type].map((operation) => ({\n          value: operation,\n          label: operationLabels[type]?.[operation] ?? operationLabels.base?.[operation] ?? ''\n        }))\n      : []\n  }, [filters, formFilterName])\n\n  // Template\n  return <Combobox value={field.value} options={options} isCanRemoveValue={false} onValueChange={changeValue} />\n}\n\nexport default AdvancedFilterOperationField\n",
      "type": "registry:ui",
      "target": "src/components/organisms/smart-filter/advanced-filter-operation-field.tsx"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/advanced-filter-value-field.tsx",
      "content": "import { toDate } from 'date-fns'\nimport { Minus } from 'lucide-react'\nimport React from 'react'\nimport { Controller, useFormContext, useWatch } from 'react-hook-form'\nimport { MultiSelect } from '@/components/molecules/multi-select'\nimport { NumberInput } from '@/components/molecules/number-input'\nimport { Combobox } from '@/components/ui/combobox'\nimport { DatePicker, DateRangePicker } from '@/components/ui/date-picker'\nimport { Field, FieldError } from '@/components/ui/field'\nimport { Input } from '@/components/ui/input'\nimport { type SmartFilterFormInput, type SmartFilterFormOutput, SmartFilterOperation, SmartFilterType } from './lib'\nimport { useSmartFilterContext } from './smart-filter'\n\n// Component\nconst AdvancedFilterValueField = ({ index }: { index: number }) => {\n  // Hooks\n  const { filters } = useSmartFilterContext()\n  const form = useFormContext<SmartFilterFormInput, unknown, SmartFilterFormOutput>()\n  const [formFilterName, formFilterOperation] = useWatch({\n    name: [`filters.${index}.name`, `filters.${index}.operation`],\n    control: form.control\n  })\n\n  // Memos\n  // Selected filter\n  const selectedFilter = React.useMemo(() => {\n    return filters.find((filter) => filter.name === formFilterName)\n  }, [filters, formFilterName])\n\n  // Template\n  if (!selectedFilter) {\n    return null\n  }\n\n  switch (selectedFilter.type) {\n    // Number\n    case SmartFilterType.Number: {\n      // Is between\n      if (formFilterOperation === SmartFilterOperation.IsBetween) {\n        const valueAdditionalWatcher = form.watch(`filters.${index}.value.additional`)\n\n        return (\n          <div className='flex items-center gap-4'>\n            <Controller\n              name={`filters.${index}.value.additional.from`}\n              control={form.control}\n              render={({ field, fieldState }) => (\n                <Field data-invalid={fieldState.invalid}>\n                  <NumberInput\n                    value={field.value}\n                    placeholder={`Enter from ${selectedFilter.label.toLowerCase()}`}\n                    onFieldChange={field.onChange}\n                    onValueChange={(event) => {\n                      field.onChange(event.value)\n                      if (+valueAdditionalWatcher.to < +event.value) {\n                        form.setValue(`filters.${index}.value.additional.to`, event.value)\n                      }\n                    }}\n                  />\n                  {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n                </Field>\n              )}\n            />\n\n            <Minus className='size-4 text-muted-foreground' />\n\n            <Controller\n              name={`filters.${index}.value.additional.to`}\n              control={form.control}\n              render={({ field, fieldState }) => (\n                <Field data-invalid={fieldState.invalid}>\n                  <NumberInput\n                    value={field.value}\n                    placeholder={`Enter to ${selectedFilter.label.toLowerCase()}`}\n                    min={valueAdditionalWatcher.from}\n                    onFieldChange={field.onChange}\n                    onValueChange={(event) => field.onChange(event.value)}\n                  />\n                  {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n                </Field>\n              )}\n            />\n          </div>\n        )\n      }\n\n      // Others else\n      return (\n        <Controller\n          name={`filters.${index}.value.default`}\n          control={form.control}\n          render={({ field, fieldState }) => (\n            <Field data-invalid={fieldState.invalid}>\n              <NumberInput\n                value={field.value as string}\n                placeholder={`Enter ${selectedFilter.label.toLowerCase()}`}\n                onFieldChange={field.onChange}\n                onValueChange={(event) => field.onChange(event.value)}\n              />\n              {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n            </Field>\n          )}\n        />\n      )\n    }\n\n    // Date\n    case SmartFilterType.Date: {\n      if (formFilterOperation === SmartFilterOperation.IsBetween) {\n        return (\n          <Controller\n            name={`filters.${index}.value.additional`}\n            control={form.control}\n            render={({ field, fieldState }) => (\n              <Field data-invalid={fieldState.invalid}>\n                <DateRangePicker\n                  value={{\n                    from: field.value.from ? new Date(field.value.from) : undefined,\n                    to: field.value.to ? new Date(field.value.to) : undefined\n                  }}\n                  placeholder={`Select ${selectedFilter.label.toLowerCase()} range`}\n                  onValueChange={(value) => {\n                    field.onChange({\n                      from: value?.from?.toISOString() ?? '',\n                      to: value?.to?.toISOString() ?? ''\n                    })\n                  }}\n                />\n                {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n              </Field>\n            )}\n          />\n        )\n      }\n\n      return (\n        <Controller\n          name={`filters.${index}.value.default`}\n          control={form.control}\n          render={({ field, fieldState }) => (\n            <Field data-invalid={fieldState.invalid}>\n              <DatePicker\n                value={field.value ? toDate(field.value as string) : null}\n                placeholder={`Select ${selectedFilter.label.toLowerCase()}`}\n                onValueChange={(value) => {\n                  field.onChange(value?.toISOString() ?? '')\n                }}\n              />\n              {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n            </Field>\n          )}\n        />\n      )\n    }\n\n    // Select\n    case SmartFilterType.Select: {\n      if (formFilterOperation === SmartFilterOperation.HasAnyOf) {\n        return (\n          <Controller\n            name={`filters.${index}.value.default`}\n            control={form.control}\n            render={({ field, fieldState }) => (\n              <Field data-invalid={fieldState.invalid}>\n                <MultiSelect\n                  value={field.value as string[]}\n                  options={selectedFilter.options ?? []}\n                  buttonTriggerProps={{\n                    isLoading: !selectedFilter.options\n                  }}\n                  placeholder={`Select ${selectedFilter.label.toLowerCase()}`}\n                  onValueChange={field.onChange}\n                />\n                {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n              </Field>\n            )}\n          />\n        )\n      }\n\n      return (\n        <Controller\n          name={`filters.${index}.value.default`}\n          control={form.control}\n          render={({ field, fieldState }) => (\n            <Field data-invalid={fieldState.invalid}>\n              <Combobox\n                value={field.value as string}\n                options={selectedFilter.options ?? []}\n                buttonTriggerProps={{\n                  isLoading: !selectedFilter.options\n                }}\n                placeholder={`Select ${selectedFilter.label.toLowerCase()}`}\n                onValueChange={(value) => {\n                  field.onChange(value ?? '')\n                }}\n              />\n              {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n            </Field>\n          )}\n        />\n      )\n    }\n\n    // Select with infinite query\n    case SmartFilterType.SelectWithInfiniteQuery: {\n      return null\n    }\n\n    // Multi select\n    case SmartFilterType.MultiSelect: {\n      return (\n        <Controller\n          name={`filters.${index}.value.default`}\n          control={form.control}\n          render={({ field, fieldState }) => (\n            <Field data-invalid={fieldState.invalid}>\n              <MultiSelect\n                value={field.value as string[]}\n                options={selectedFilter.options ?? []}\n                buttonTriggerProps={{\n                  isLoading: !selectedFilter.options\n                }}\n                placeholder={`Select ${selectedFilter.label.toLowerCase()}`}\n                onValueChange={field.onChange}\n              />\n              {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n            </Field>\n          )}\n        />\n      )\n    }\n\n    // Default\n    default: {\n      return (\n        <Controller\n          name={`filters.${index}.value.default`}\n          control={form.control}\n          render={({ field, fieldState }) => (\n            <Field data-invalid={fieldState.invalid}>\n              <Input\n                aria-invalid={fieldState.invalid}\n                placeholder={`Enter ${selectedFilter.label.toLowerCase()}`}\n                {...field}\n              />\n              {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n            </Field>\n          )}\n        />\n      )\n    }\n  }\n}\n\nexport default AdvancedFilterValueField\n",
      "type": "registry:ui",
      "target": "src/components/organisms/smart-filter/advanced-filter-value-field.tsx"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/advanced-filter.tsx",
      "content": "import { CircleCheckBig, ListFilter, Plus, RefreshCw, TrashIcon } from 'lucide-react'\nimport React from 'react'\nimport { Controller, type UseFieldArrayReturn, useFormContext, useWatch } from 'react-hook-form'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { Field, FieldError } from '@/components/ui/field'\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\nimport AdvancedFilterNameField from './advanced-filter-name-field'\nimport AdvancedFilterOperationField from './advanced-filter-operation-field'\nimport AdvancedFilterValueField from './advanced-filter-value-field'\nimport { defaultSmartFilterFormValue, type Filter, type SmartFilterFormInput, type SmartFilterFormOutput } from './lib'\nimport { type SmartFilterProps, useSmartFilterContext } from './smart-filter'\n\n// Component\nconst AdvancedFilter = ({\n  formFilters,\n  addFilter,\n  setFilters\n}: Pick<SmartFilterProps, 'setFilters'> & {\n  formFilters: UseFieldArrayReturn<SmartFilterFormInput, 'filters'>\n  addFilter: (filter: Filter) => void\n}) => {\n  // Hooks\n  const { filters } = useSmartFilterContext()\n  const form = useFormContext<SmartFilterFormInput, unknown, SmartFilterFormOutput>()\n  const formFiltersWatcher = useWatch({\n    control: form.control,\n    name: 'filters'\n  })\n\n  // States\n  const [isOpenPopover, setIsOpenPopover] = React.useState(false)\n  const [totalFilterApplied, setTotalFilterApplied] = React.useState(form.formState.defaultValues?.filters?.length ?? 0)\n\n  // Methods\n  const executeLogicOnOpenPopover = () => {\n    if (formFilters.fields.length === 0) {\n      addFilter(filters[0])\n    }\n  }\n\n  const clickAddingButton = () => {\n    const selectedFilters = formFiltersWatcher.map((field) => field.name)\n    const unSelectFilters = filters.filter((filter) => !selectedFilters.includes(filter.name))\n    if (unSelectFilters.length > 0) {\n      addFilter(unSelectFilters[0])\n    }\n  }\n\n  const resetFilter = () => {\n    formFilters.remove()\n    setTotalFilterApplied(0)\n    setFilters(defaultSmartFilterFormValue)\n    if (filters.length > 0) {\n      addFilter(filters[0])\n    }\n  }\n\n  const applyFilter = (fieldValues: SmartFilterFormOutput) => {\n    setFilters(fieldValues)\n    setTotalFilterApplied(fieldValues.filters.length)\n    setIsOpenPopover(false)\n  }\n\n  // Template\n  return (\n    <Popover open={isOpenPopover} onOpenChange={setIsOpenPopover}>\n      <PopoverTrigger asChild>\n        <Button variant='outline'>\n          <span>Filters</span>\n          <ListFilter />\n          {totalFilterApplied > 0 && (\n            <Badge variant='secondary' className='flex size-5 items-center justify-center rounded-sm p-0 leading-none'>\n              {totalFilterApplied}\n            </Badge>\n          )}\n        </Button>\n      </PopoverTrigger>\n\n      <PopoverContent\n        align='start'\n        className='w-(--radix-popper-available-width) xl:w-auto'\n        onOpenAutoFocus={executeLogicOnOpenPopover}\n      >\n        <h3 className='typography-h3'>Filters</h3>\n        <div className='-mx-1 my-2 max-h-72 overflow-y-auto px-1'>\n          {/* Filters */}\n          {formFilters.fields.map((field, index) => (\n            <div key={field.id} className='flex gap-x-4'>\n              <div className='flex grow flex-col gap-4 py-2 xl:w-auto xl:flex-row'>\n                {/* Name */}\n                <Controller\n                  name={`filters.${index}.name`}\n                  control={form.control}\n                  render={({ field, fieldState }) => (\n                    <Field data-invalid={fieldState.invalid} className='w-full shrink-0 xl:w-52'>\n                      <AdvancedFilterNameField index={index} field={field} formFiltersWatcher={formFiltersWatcher} />\n                      {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n                    </Field>\n                  )}\n                />\n\n                {/* Operation */}\n                <Controller\n                  name={`filters.${index}.operation`}\n                  control={form.control}\n                  render={({ field, fieldState }) => (\n                    <Field data-invalid={fieldState.invalid} className='w-full shrink-0 xl:w-52'>\n                      <AdvancedFilterOperationField index={index} field={field} />\n                      {fieldState.invalid && <FieldError errors={[fieldState.error]} />}\n                    </Field>\n                  )}\n                />\n\n                {/* Value */}\n                <AdvancedFilterValueField index={index} />\n              </div>\n\n              {/* Remove button */}\n              {formFilters.fields.length > 1 && (\n                <Button\n                  variant='outline'\n                  size='icon'\n                  className='mt-2 shrink-0'\n                  onClick={() => formFilters.remove(index)}\n                >\n                  <TrashIcon className='h-4 w-4' />\n                </Button>\n              )}\n            </div>\n          ))}\n        </div>\n\n        {/* Actions */}\n        <div className='flex items-center justify-end gap-4'>\n          {formFilters.fields.length < filters.length && (\n            <Button variant='outline' onClick={clickAddingButton}>\n              <Plus />\n              <span>Add</span>\n            </Button>\n          )}\n\n          <Button variant='secondary' onClick={resetFilter}>\n            <RefreshCw />\n            <span>Reset</span>\n          </Button>\n\n          <Button type='submit' onClick={form.handleSubmit(applyFilter)}>\n            <CircleCheckBig />\n            <span>Apply</span>\n          </Button>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nexport default AdvancedFilter\n",
      "type": "registry:ui",
      "target": "src/components/organisms/smart-filter/advanced-filter.tsx"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/basic-search.tsx",
      "content": "import { useDebounce } from '@uidotdev/usehooks'\nimport { Search } from 'lucide-react'\nimport React from 'react'\nimport { Controller, useFormContext, useWatch } from 'react-hook-form'\nimport { Field } from '@/components/ui/field'\nimport { InputGroup, InputGroupAddon, InputGroupInput } from '@/components/ui/input-group'\nimport type { SmartFilterFormInput, SmartFilterFormOutput } from './lib'\nimport type { SmartFilterProps } from './smart-filter'\n\n// Component\nconst BasicSearch = ({ setFilters }: Pick<SmartFilterProps, 'setFilters'>) => {\n  // Hooks\n  const form = useFormContext<SmartFilterFormInput, unknown, SmartFilterFormOutput>()\n\n  const formSearch = useWatch({\n    name: 'search',\n    control: form.control\n  })\n\n  const debouncedFormSearch = useDebounce<string>(formSearch.trim(), 400)\n\n  // Effects\n  React.useEffect(() => {\n    setFilters({ search: debouncedFormSearch, filters: [] })\n  }, [debouncedFormSearch, setFilters])\n\n  // Template\n  return (\n    <Controller\n      name='search'\n      control={form.control}\n      render={({ field, fieldState }) => (\n        <Field data-invalid={fieldState.invalid}>\n          <InputGroup>\n            <InputGroupInput {...field} aria-invalid={fieldState.invalid} placeholder='Search' />\n            <InputGroupAddon>\n              <Search />\n            </InputGroupAddon>\n          </InputGroup>\n        </Field>\n      )}\n    />\n  )\n}\n\nexport default BasicSearch\n",
      "type": "registry:ui",
      "target": "src/components/organisms/smart-filter/basic-search.tsx"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/index.ts",
      "content": "export * from './lib'\nexport * from './smart-filter'\n",
      "type": "registry:file",
      "target": "src/components/organisms/smart-filter/index.ts"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/lib.ts",
      "content": "import { zodResolver } from '@hookform/resolvers/zod'\nimport { useForm } from 'react-hook-form'\nimport z from 'zod'\n\nexport enum SmartFilterLogicalOperation {\n  And = ',',\n  Or = '|'\n}\n\nexport enum SmartFilterOperation {\n  EqualsTo = 'equalsTo',\n  DoesNotEqualTo = 'doesNotEqualTo',\n  Contains = 'contains',\n  IsLessThan = 'isLessThan',\n  IsLessThanOrEqualTo = 'isLessThanOrEqualTo',\n  IsGreaterThan = 'isGreaterThan',\n  IsGreaterThanOrEqualTo = 'isGreaterThanOrEqualTo',\n  IsBetween = 'isBetween',\n  HasAnyOf = 'hasAnyOf',\n  HasAllOf = 'hasAllOf'\n}\n\nexport enum SmartFilterType {\n  Text = 'text',\n  Number = 'number',\n  Date = 'date',\n  Select = 'select',\n  SelectWithInfiniteQuery = 'select-with-infinite-query',\n  MultiSelect = 'multi-select'\n}\n\nexport enum SmartFilterApiOperation {\n  Equal = '==',\n  NotEqual = '!=',\n  LessThan = '<',\n  GreaterThan = '>',\n  LessThanOrEqual = '<=',\n  GreaterThanOrEqual = '>=',\n  Contain = '@=',\n  StartWith = '_=',\n  NotStartWith = '!_=',\n  CaseInsensitiveStringContain = '@=*',\n  CaseInsensitiveStringNotContain = '!@=*',\n  CaseInsensitiveStartWith = '_=*',\n  CaseInsensitiveNotStartWith = '!_=*',\n  CaseInsensitiveEqual = '==*',\n  CaseInsensitiveNotEqual = '!=*',\n  EqualArray = '[]'\n}\n\nexport const operationsPerType: Record<SmartFilterType, SmartFilterOperation[]> = {\n  [SmartFilterType.Text]: [\n    SmartFilterOperation.EqualsTo,\n    SmartFilterOperation.DoesNotEqualTo,\n    SmartFilterOperation.Contains\n  ],\n  [SmartFilterType.Number]: [\n    SmartFilterOperation.EqualsTo,\n    SmartFilterOperation.DoesNotEqualTo,\n    SmartFilterOperation.IsLessThan,\n    SmartFilterOperation.IsLessThanOrEqualTo,\n    SmartFilterOperation.IsGreaterThan,\n    SmartFilterOperation.IsGreaterThanOrEqualTo,\n    SmartFilterOperation.IsBetween\n  ],\n  [SmartFilterType.Date]: [\n    SmartFilterOperation.EqualsTo,\n    SmartFilterOperation.IsLessThan,\n    SmartFilterOperation.IsLessThanOrEqualTo,\n    SmartFilterOperation.IsGreaterThan,\n    SmartFilterOperation.IsGreaterThanOrEqualTo,\n    SmartFilterOperation.IsBetween\n  ],\n  [SmartFilterType.Select]: [\n    SmartFilterOperation.EqualsTo,\n    SmartFilterOperation.DoesNotEqualTo,\n    SmartFilterOperation.HasAnyOf\n  ],\n  [SmartFilterType.SelectWithInfiniteQuery]: [\n    SmartFilterOperation.EqualsTo,\n    SmartFilterOperation.DoesNotEqualTo,\n    SmartFilterOperation.HasAnyOf\n  ],\n  [SmartFilterType.MultiSelect]: [SmartFilterOperation.HasAnyOf, SmartFilterOperation.HasAllOf]\n} as const\n\nexport const defaultStringValue = {\n  default: '',\n  additional: {\n    from: '',\n    to: ''\n  }\n} as const\n\nexport const defaultStringArrayValue = {\n  default: '',\n  additional: {\n    from: '',\n    to: ''\n  }\n} as const\n\nexport const defaultValuePerOperation: Record<SmartFilterOperation, SmartFilterFormOutput['filters'][number]['value']> =\n  {\n    [SmartFilterOperation.EqualsTo]: defaultStringValue,\n    [SmartFilterOperation.DoesNotEqualTo]: defaultStringValue,\n    [SmartFilterOperation.IsLessThan]: defaultStringValue,\n    [SmartFilterOperation.IsLessThanOrEqualTo]: defaultStringValue,\n    [SmartFilterOperation.IsGreaterThan]: defaultStringValue,\n    [SmartFilterOperation.IsGreaterThanOrEqualTo]: defaultStringValue,\n    [SmartFilterOperation.Contains]: defaultStringValue,\n    [SmartFilterOperation.IsBetween]: defaultStringValue,\n    [SmartFilterOperation.HasAnyOf]: defaultStringArrayValue,\n    [SmartFilterOperation.HasAllOf]: defaultStringArrayValue\n  } as const\n\nexport const apiOperationPerOperation: Partial<Record<SmartFilterOperation, SmartFilterApiOperation>> = {\n  [SmartFilterOperation.EqualsTo]: SmartFilterApiOperation.Equal,\n  [SmartFilterOperation.DoesNotEqualTo]: SmartFilterApiOperation.NotEqual,\n  [SmartFilterOperation.IsLessThan]: SmartFilterApiOperation.LessThan,\n  [SmartFilterOperation.IsLessThanOrEqualTo]: SmartFilterApiOperation.LessThanOrEqual,\n  [SmartFilterOperation.IsGreaterThan]: SmartFilterApiOperation.GreaterThan,\n  [SmartFilterOperation.IsGreaterThanOrEqualTo]: SmartFilterApiOperation.GreaterThanOrEqual,\n  [SmartFilterOperation.Contains]: SmartFilterApiOperation.Contain\n} as const\n\nexport const smartFilterFormSchema = z.object({\n  search: z.string().trim(),\n  filters: z.array(\n    z\n      .object({\n        name: z.string().trim(),\n        operation: z.enum(SmartFilterOperation),\n        type: z.enum(SmartFilterType),\n        value: z.object({\n          default: z.union([z.string().trim(), z.array(z.string()).min(1, 'Please enter/select the information')]),\n          additional: z.object({\n            from: z.string(),\n            to: z.string()\n          })\n        })\n      })\n      .superRefine((fieldValues, ctx) => {\n        const { value, operation } = fieldValues\n\n        if (operation === SmartFilterOperation.IsBetween) {\n          if (value.additional.from === '') {\n            ;['value.additional', 'value.additional.from'].forEach((path) => {\n              ctx.addIssue({\n                path: [path],\n                message: 'Please enter/select the information',\n                code: 'custom'\n              })\n            })\n          }\n\n          if (value.additional.to === '') {\n            ;['value.additional', 'value.additional.to'].forEach((path) => {\n              ctx.addIssue({\n                path: [path],\n                message: 'Please enter/select the information',\n                code: 'custom'\n              })\n            })\n          }\n        } else {\n          if (value.default === '') {\n            ctx.addIssue({\n              path: ['value.default'],\n              message: 'Please enter/select the information',\n              code: 'custom'\n            })\n          }\n        }\n      })\n  )\n})\n\nexport const defaultSmartFilterFormValue: SmartFilterFormInput = {\n  search: '',\n  filters: []\n} as const\n\nexport interface Filter {\n  label: string\n  name: string\n  type: SmartFilterType\n  options?: Array<{\n    value: string\n    label: string\n  }>\n  apiPath?: string\n  datePickerFormat?: 'date' | 'month' | 'year'\n}\n\nexport type SmartFilterFormInput = z.input<typeof smartFilterFormSchema>\n\nexport type SmartFilterFormOutput = z.output<typeof smartFilterFormSchema>\n\nexport const useSmartFilterForm = ({ defaultFormValue }: { defaultFormValue?: SmartFilterFormInput } = {}) => {\n  return useForm<SmartFilterFormInput, unknown, SmartFilterFormOutput>({\n    resolver: zodResolver(smartFilterFormSchema),\n    defaultValues: defaultFormValue ?? defaultSmartFilterFormValue\n  })\n}\n",
      "type": "registry:file",
      "target": "src/components/organisms/smart-filter/lib.ts"
    },
    {
      "path": "src/registry/new-york/organisms/smart-filter/components/smart-filter.tsx",
      "content": "import { ListFilter, Search } from 'lucide-react'\nimport React from 'react'\nimport { FormProvider, type SubmitHandler, type UseFormReturn, useFieldArray } from 'react-hook-form'\nimport { ToggleGroup, ToggleGroupItem } from '@/components/ui/toggle-group'\nimport AdvancedFilter from './advanced-filter'\nimport BasicSearch from './basic-search'\nimport {\n  defaultValuePerOperation,\n  type Filter,\n  operationsPerType,\n  type SmartFilterFormInput,\n  type SmartFilterFormOutput\n} from './lib'\n\n// Smart filter\nenum Mode {\n  BasicSearch = 'basic-search',\n  AdvancedFilter = 'advanced-filter'\n}\n\nexport interface SmartFilterContextValue {\n  filters: NonNullable<SmartFilterProps['filters']>\n}\n\nconst SmartFilterContext = React.createContext<SmartFilterContextValue | null>(null)\n\nexport const useSmartFilterContext = () => {\n  const context = React.useContext(SmartFilterContext)\n  if (!context) {\n    throw new Error('useFiltersContext should be used within the SmartFilter')\n  }\n  return context\n}\n\nexport interface SmartFilterProps {\n  form: UseFormReturn<SmartFilterFormInput, unknown, SmartFilterFormOutput>\n  filters?: Filter[]\n  isHideSearchMode?: boolean\n  setFilters: SubmitHandler<SmartFilterFormOutput>\n}\n\nconst DEFAULT_FILTERS: Filter[] = []\n\nexport const SmartFilter = ({\n  form,\n  filters = DEFAULT_FILTERS,\n  isHideSearchMode = false,\n  setFilters\n}: SmartFilterProps) => {\n  // Hooks\n  const formFilters = useFieldArray({\n    control: form.control,\n    name: 'filters'\n  })\n\n  // States\n  const [mode, setMode] = React.useState<Mode>(() =>\n    (form.formState.defaultValues?.filters ?? DEFAULT_FILTERS).length > 0 ? Mode.AdvancedFilter : Mode.BasicSearch\n  )\n\n  // Methods\n  const addFilter = (filter: Filter) => {\n    const { name, type } = filter\n    const operation = operationsPerType[type][0]\n    formFilters.append({\n      name,\n      type,\n      operation,\n      value: defaultValuePerOperation[operation]\n    })\n  }\n\n  const changeMode = (value: string) => {\n    setMode(value as Mode)\n    switch (value) {\n      case Mode.BasicSearch:\n        formFilters.remove()\n        break\n\n      case Mode.AdvancedFilter:\n        form.resetField('search')\n        if (filters.length > 0) {\n          addFilter(filters[0])\n        }\n        break\n    }\n  }\n\n  // Template\n  if (form.formState.isLoading) {\n    return null\n  }\n\n  return (\n    <SmartFilterContext.Provider\n      value={{\n        filters\n      }}\n    >\n      <FormProvider {...form}>\n        <form className='w-full' onSubmit={(e) => e.preventDefault()}>\n          {filters.length === 0 ? (\n            <BasicSearch setFilters={setFilters} />\n          ) : isHideSearchMode ? (\n            <AdvancedFilter formFilters={formFilters} addFilter={addFilter} setFilters={setFilters} />\n          ) : (\n            <div className='flex items-center gap-2'>\n              <ToggleGroup\n                type='single'\n                size='lg'\n                variant='outline'\n                value={mode}\n                className='data-[variant=outline]:shadow-none'\n                onValueChange={changeMode}\n              >\n                <ToggleGroupItem value={Mode.BasicSearch}>\n                  <Search className='size-4' />\n                </ToggleGroupItem>\n\n                <ToggleGroupItem value={Mode.AdvancedFilter}>\n                  <ListFilter className='size-4' />\n                </ToggleGroupItem>\n              </ToggleGroup>\n\n              {mode === Mode.BasicSearch ? (\n                <BasicSearch setFilters={setFilters} />\n              ) : (\n                <AdvancedFilter formFilters={formFilters} addFilter={addFilter} setFilters={setFilters} />\n              )}\n            </div>\n          )}\n        </form>\n      </FormProvider>\n    </SmartFilterContext.Provider>\n  )\n}\n",
      "type": "registry:ui",
      "target": "src/components/organisms/smart-filter/smart-filter.tsx"
    }
  ]
}